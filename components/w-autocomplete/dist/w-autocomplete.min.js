var WAutocomplete=function(e){"use strict";function t(){var e=document.head||document.getElementsByTagName("head")[0],n=t.styles||(t.styles={}),i="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(t,s){if(!document.querySelector('style[data-vue-ssr-id~="'+t+'"]')){var o=i?s.media||"default":t,l=n[o]||(n[o]={ids:[],parts:[],element:void 0});if(!l.ids.includes(t)){var r=s.source,d=l.ids.length;if(l.ids.push(t),i&&(l.element=l.element||document.querySelector("style[data-group="+o+"]")),!l.element){var A=l.element=document.createElement("style");A.type="text/css",s.media&&A.setAttribute("media",s.media),i&&(A.setAttribute("data-group",o),A.setAttribute("data-next-index","0")),e.appendChild(A)}if(i&&(d=parseInt(l.element.getAttribute("data-next-index")),l.element.setAttribute("data-next-index",d+1)),l.element.styleSheet)l.parts.push(r),l.element.styleSheet.cssText=l.parts.filter(Boolean).join("\n");else{var a=document.createTextNode(r),c=l.element.childNodes;c[d]&&l.element.removeChild(c[d]),c.length?l.element.insertBefore(a,c[d]):l.element.appendChild(a)}}}}}function n(e){n.installed||(n.installed=!0,e.component("WAutocomplete",r))}var i=null,s={name:"WAutocomplete",props:{id:{required:!0},filterby:{type:String},title:{default:"Select One...",type:String},url:{type:String},shouldReset:{type:Boolean,default:!0}},data:function(){return{itemHeight:39,selectedItem:null,selected:0,query:"",visible:!1,items:[],isLoading:!1}},methods:{getItems:function(){var e=this;this.isLoading=!0;var t=this.url.replace("__query__",this.query);axios.get(t).then(function(e){return e.data}).then(function(e){return e.content}).then(function(t){e.items=t,e.isLoading=!1})},toggleVisible:function(){var e=this;this.visible=!this.visible,setTimeout(function(){e.$refs.input.focus()},50)},itemClicked:function(e){this.selected=e,this.selectItem()},selectItem:function(){this.matches.length&&(this.selectedItem=this.matches[this.selected],this.visible=!1,this.shouldReset&&(this.query="",this.selected=0),this.$emit("selected",JSON.parse(JSON.stringify(this.selectedItem))))},up:function(){0!=this.selected&&(this.selected-=1,this.scrollToItem())},down:function(){this.selected>=this.matches.length-1||(this.selected+=1,this.scrollToItem())},scrollToItem:function(){this.$refs.optionsList.scrollTop=this.selected*this.itemHeight}},watch:{query:function(){i()}},computed:{matches:function(){var e=this;return this.$emit("change",this.query),""==this.query?this.items.slice(0,10):this.items.filter(function(t){return t[e.filterby].toLowerCase().includes(e.query.toLowerCase())})},selectedId:function(){if(this.selectedItem)return this.selectedItem.id}},mounted:function(){var e=this;this.$nextTick(function(){i=_.debounce(e.getItems,200),e.getItems()})}},o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"autocomplete"},[n("div",{staticClass:"input",domProps:{textContent:e._s(e.selectedItem?e.selectedItem[e.filterby]:"")},on:{click:e.toggleVisible}}),e._v(" "),null==e.selectedItem?n("div",{staticClass:"placeholder",domProps:{textContent:e._s(e.title)}}):e._e(),e._v(" "),e.selectedItem?n("button",{staticClass:"close",on:{click:function(t){e.selectedItem=null}}},[e._v("x")]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"popover"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],ref:"input",attrs:{type:"text",placeholder:"Start Typing..."},domProps:{value:e.query},on:{keydown:[function(t){return"button"in t||!e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?e.up(t):null},function(t){return"button"in t||!e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?e.down(t):null},function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?(t.preventDefault(),e.selectItem(t)):null}],input:function(t){t.target.composing||(e.query=t.target.value)}}}),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],staticClass:"options"},[e._v("LOADING...")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],ref:"optionsList",staticClass:"options"},[n("ul",e._l(e.matches,function(t,i){return n("li",{key:i,class:{selected:e.selected==i},domProps:{textContent:e._s(t[e.filterby])},on:{click:function(t){e.itemClicked(i)}}})}))])])])},l=[];o._withStripped=!0;var r=function(e,t,n,i,s,o,l,r){var d=("function"==typeof n?n.options:n)||{};d.__file="/Users/armandohm/web2py/applications/waves/components/w-autocomplete/src/w-autocomplete.vue",d.render||(d.render=e.render,d.staticRenderFns=e.staticRenderFns,d._compiled=!0,s&&(d.functional=!0)),d._scopeId=i;var A;if(t&&(A=function(e){t.call(this,l(e))}),void 0!==A)if(d.functional){var a=d.render;d.render=function(e,t){return A.call(t),a(e,t)}}else{var c=d.beforeCreate;d.beforeCreate=c?[].concat(c,A):[A]}return d}({render:o,staticRenderFns:l},function(e){e&&e("data-v-a6a304d6_0",{source:"\n.autocomplete[data-v-a6a304d6] {\n  width: 100%;\n  position: relative;\n}\n.input[data-v-a6a304d6] {\n  height: 40px;\n  border-radius: 3px;\n  border: 2px solid lightgray;\n  box-shadow: 0 0 10px #eceaea;\n  font-size: 25px;\n  padding-left: 10px;\n  padding-top: 10px;\n  cursor: text;\n}\n.close[data-v-a6a304d6] {\n  position: absolute;\n  right: 2px;\n  top: 4px;\n  background: none;\n  border: none;\n  font-size: 30px;\n  color: lightgrey;\n  cursor: pointer;\n}\n.placeholder[data-v-a6a304d6] {\n  position: absolute;\n  top: 11px;\n  left: 11px;\n  font-size: 25px;\n  color: #d0d0d0;\n  pointer-events: none;\n}\n.popover[data-v-a6a304d6] {\n  min-height: 50px;\n  border: 2px solid lightgray;\n  position: absolute;\n  top: 46px;\n  left: 0;\n  right: 0;\n  background: #fff;\n  border-radius: 3px;\n  text-align: center;\n}\n.popover input[data-v-a6a304d6] {\n  width: 95%;\n  margin-top: 5px;\n  height: 40px;\n  font-size: 16px;\n  border-radius: 3px;\n  border: 1px solid lightgray;\n  padding-left: 8px;\n}\n.options[data-v-a6a304d6] {\n  max-height: 150px;\n  overflow-y: scroll;\n  margin-top: 5px;\n}\n.options ul[data-v-a6a304d6] {\n  list-style-type: none;\n  text-align: left;\n  padding-left: 0;\n}\n.options ul li[data-v-a6a304d6] {\n  border-bottom: 1px solid lightgray;\n  padding: 10px;\n  cursor: pointer;\n  background: #f1f1f1;\n}\n.options ul li[data-v-a6a304d6]:first-child {\n  border-top: 2px solid #d6d6d6;\n}\n.options ul li[data-v-a6a304d6]:not(.selected):hover {\n  background: #8c8c8c;\n  color: #fff;\n}\n.options ul li.selected[data-v-a6a304d6] {\n  background: #58bd4c;\n  color: #fff;\n  font-weight: 600;\n}\n",map:{version:3,sources:["/Users/armandohm/web2py/applications/waves/components/w-autocomplete/src/w-autocomplete.vue"],names:[],mappings:";AAuJA;EACA,YAAA;EACA,mBAAA;CACA;AACA;EACA,aAAA;EACA,mBAAA;EACA,4BAAA;EACA,6BAAA;EACA,gBAAA;EACA,mBAAA;EACA,kBAAA;EACA,aAAA;CACA;AACA;EACA,mBAAA;EACA,WAAA;EACA,SAAA;EACA,iBAAA;EACA,aAAA;EACA,gBAAA;EACA,iBAAA;EACA,gBAAA;CACA;AACA;EACA,mBAAA;EACA,UAAA;EACA,WAAA;EACA,gBAAA;EACA,eAAA;EACA,qBAAA;CACA;AACA;EACA,iBAAA;EACA,4BAAA;EACA,mBAAA;EACA,UAAA;EACA,QAAA;EACA,SAAA;EACA,iBAAA;EACA,mBAAA;EACA,mBAAA;CACA;AACA;EACA,WAAA;EACA,gBAAA;EACA,aAAA;EACA,gBAAA;EACA,mBAAA;EACA,4BAAA;EACA,kBAAA;CACA;AACA;EACA,kBAAA;EACA,mBAAA;EACA,gBAAA;CACA;AACA;EACA,sBAAA;EACA,iBAAA;EACA,gBAAA;CACA;AACA;EACA,mCAAA;EACA,cAAA;EACA,gBAAA;EACA,oBAAA;CACA;AACA;EACA,8BAAA;CACA;AACA;EACA,oBAAA;EACA,YAAA;CACA;AACA;EACA,oBAAA;EACA,YAAA;EACA,iBAAA;CACA",file:"w-autocomplete.vue",sourcesContent:['<template>\n    <div class="autocomplete">\n        \x3c!-- <slot></slot> --\x3e\n        \x3c!-- <input :id="id+\'__selectedId\'" :name="id+\'__selectedId\'" v-model="selectedId" type="text" hidden>  --\x3e\n        <div class="input" @click="toggleVisible" v-text="selectedItem ? selectedItem[filterby] : \'\'"></div>\n        <div class="placeholder" v-if="selectedItem == null" v-text="title"></div>\n        <button class="close" @click="selectedItem = null" v-if="selectedItem">x</button>\n        <div class="popover" v-show="visible">\n            <input type="text" ref="input" v-model="query" @keydown.up="up" @keydown.down="down" @keydown.enter.prevent="selectItem" placeholder="Start Typing...">\n            <div class="options" v-show="isLoading">LOADING...</div>\n            <div class="options" v-show="!isLoading" ref="optionsList">\n                <ul>\n                    <li v-for="(match, index) in matches" :key="index" :class="{ \'selected\': (selected == index)}" @click="itemClicked(index)" v-text="match[filterby]"></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n//import axios from "axios";\n\nlet debounced = null;\nexport default {\n  name: "WAutocomplete", // vue component name\n\n  props: {\n    // items: {\n    //   default: function() {\n    //       return []\n    //       },\n    //   type: Array\n    // },\n    id: {\n        required: true\n    },\n    filterby: {\n      type: String\n    },\n    title: {\n      default: "Select One...",\n      type: String\n    },\n    url: {\n      type: String\n    },\n    shouldReset: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data() {\n    return {\n      itemHeight: 39,\n      selectedItem: null,\n      selected: 0,\n      query: "",\n      visible: false,\n      items: [],\n      isLoading: false,\n      //element: null,\n    };\n  },\n  methods: {\n    getItems() {\n      this.isLoading = true;\n      var url = this.url.replace(\'__query__\',this.query)\n      axios\n        .get(url)\n        .then(res => res.data)\n        .then(data => data.content)\n        .then(content => {\n          this.items = content;\n          this.isLoading = false;\n        });\n    },\n    toggleVisible() {\n      this.visible = !this.visible;\n      setTimeout(() => {\n        this.$refs.input.focus();\n      }, 50);\n    },\n    itemClicked(index) {\n      this.selected = index;\n      this.selectItem();\n    },\n    selectItem() {\n      if (!this.matches.length) {\n        return;\n      }\n      this.selectedItem = this.matches[this.selected];\n      //this.element.val(this.selectedItem[this.filterby])\n      this.visible = false;\n      if (this.shouldReset) {\n        this.query = "";\n        this.selected = 0;\n      }\n      this.$emit("selected", JSON.parse(JSON.stringify(this.selectedItem)));\n    },\n    up() {\n      if (this.selected == 0) {\n        return;\n      }\n      this.selected -= 1;\n      this.scrollToItem();\n    },\n    down() {\n      if (this.selected >= this.matches.length - 1) {\n        return;\n      }\n      this.selected += 1;\n      this.scrollToItem();\n    },\n    scrollToItem() {\n      this.$refs.optionsList.scrollTop = this.selected * this.itemHeight;\n    }\n  },\n  watch: {\n    query() {\n      debounced();\n    }\n  },\n  computed: {\n    matches() {\n      this.$emit("change", this.query);\n      if (this.query == "") {\n        return this.items.slice(0, 10);\n      }\n      return this.items.filter(item =>\n        item[this.filterby].toLowerCase().includes(this.query.toLowerCase())\n      );\n    },\n    selectedId() {\n      if (this.selectedItem) {\n        return this.selectedItem[\'id\']\n      }\n    }\n  },\n  mounted() {\n      this.$nextTick(() => {\n          debounced = _.debounce(this.getItems, 200);\n          this.getItems();\n          //this.element = jQuery(\'#\'+this.id)\n          //this.query = this.element.val()\n\n      })\n  }\n};\n<\/script>\n\n<style scoped>\n.autocomplete {\n  width: 100%;\n  position: relative;\n}\n.input {\n  height: 40px;\n  border-radius: 3px;\n  border: 2px solid lightgray;\n  box-shadow: 0 0 10px #eceaea;\n  font-size: 25px;\n  padding-left: 10px;\n  padding-top: 10px;\n  cursor: text;\n}\n.close {\n  position: absolute;\n  right: 2px;\n  top: 4px;\n  background: none;\n  border: none;\n  font-size: 30px;\n  color: lightgrey;\n  cursor: pointer;\n}\n.placeholder {\n  position: absolute;\n  top: 11px;\n  left: 11px;\n  font-size: 25px;\n  color: #d0d0d0;\n  pointer-events: none;\n}\n.popover {\n  min-height: 50px;\n  border: 2px solid lightgray;\n  position: absolute;\n  top: 46px;\n  left: 0;\n  right: 0;\n  background: #fff;\n  border-radius: 3px;\n  text-align: center;\n}\n.popover input {\n  width: 95%;\n  margin-top: 5px;\n  height: 40px;\n  font-size: 16px;\n  border-radius: 3px;\n  border: 1px solid lightgray;\n  padding-left: 8px;\n}\n.options {\n  max-height: 150px;\n  overflow-y: scroll;\n  margin-top: 5px;\n}\n.options ul {\n  list-style-type: none;\n  text-align: left;\n  padding-left: 0;\n}\n.options ul li {\n  border-bottom: 1px solid lightgray;\n  padding: 10px;\n  cursor: pointer;\n  background: #f1f1f1;\n}\n.options ul li:first-child {\n  border-top: 2px solid #d6d6d6;\n}\n.options ul li:not(.selected):hover {\n  background: #8c8c8c;\n  color: #fff;\n}\n.options ul li.selected {\n  background: #58bd4c;\n  color: #fff;\n  font-weight: 600;\n}\n</style>\n']},media:void 0})},s,"data-v-a6a304d6",!1,void 0,t,void 0),d={install:n},A=null;return"undefined"!=typeof window?A=window.Vue:"undefined"!=typeof global&&(A=global.Vue),A&&A.use(d),e.default=r,e}({});
